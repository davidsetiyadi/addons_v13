<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="web.webclient_bootstrap">
        <t t-call="web.layout">
            <t t-set="head_web">
                <script type="text/javascript">
                    odoo.session_info = <t t-raw="json.dumps(session_info)"/>;
                    odoo.reloadMenus = function () {
                        return new Promise(function(resolve, reject) {
                            function onLoaded() {
                                resolve(oReq.response);
                            }
                            var oReq = new XMLHttpRequest();
                            oReq.responseType = "json";
                            oReq.addEventListener("load", onLoaded);
                            oReq.addEventListener("error", reject);
                            oReq.open("GET", '/web/webclient/load_menus/' + odoo.session_info.cache_hashes.load_menus);
                            oReq.send();
                        });
                    }
                    odoo.loadMenusPromise = odoo.reloadMenus();

                    odoo.reloadTopMenus = function () {
                        return new Promise(function(resolve, reject) {
                            function onLoaded() {
                                resolve(oReq.response);
                            }
                            var oReq = new XMLHttpRequest();
                            oReq.responseType = "json";
                            oReq.addEventListener("load", onLoaded);
                            oReq.addEventListener("error", reject);
                            oReq.open("GET", '/web/webclient/load_top_menus/' + odoo.session_info.cache_hashes.load_top_menus);
                            oReq.send();
                        });
                    }
                    odoo.loadTopMenusPromise = odoo.reloadTopMenus();
                </script>
                <t t-call-assets="web.assets_common" t-js="false"/>
                <t t-call-assets="web.assets_backend" t-js="false"/>
                <t t-call-assets="web.assets_common" t-css="false"/>
                <t t-call-assets="web.assets_backend" t-css="false"/>
                <t t-call="web.conditional_assets_tests"/>

                <![CDATA[
                    <!--[if lt IE 10]>
                        <body class="ie9">
                    <![endif]-->
                ]]>

                <script type="text/javascript">
                    odoo.define('web.web_client', function (require) {
                        var WebClient = require('web.WebClient');
                        var web_client = new WebClient();
                        $(function() {
                            web_client.setElement($(document.body));
                            web_client.start();
                        });
                        return web_client;
                    });
                </script>
            </t>
            <t t-set="head" t-value="head_web + (head or '')"/>
            <t t-set="body_classname" t-value="'o_web_client'"/>
        </t>
    </template>
    
    <template id="assets_backend" name="gbr_assets_backend" inherit_id="web.assets_backend">
        <xpath expr="//script[last()]" position="after">
            <script type="text/javascript" src="/gbr_ui_custom/static/src/js/views/abstract_controller.js"></script>
            <script type="text/javascript" src="/gbr_ui_custom/static/src/js/views/list/list_renderer.js"></script>
            <script type="text/javascript" src="/gbr_ui_custom/static/src/js/chrome/abstract_web_client.js"></script>
            <script type="text/javascript" src="/gbr_ui_custom/static/src/js/chrome/menu.js"/>
            <script type="text/javascript" src="/gbr_ui_custom/static/src/js/chrome/web_client.js"/>
        </xpath>
        <xpath expr="//link[last()]" position="after">
            <link rel="stylesheet" type="text/scss" href="/gbr_ui_custom/static/src/scss/style.scss"/>
        </xpath>
    </template>
</odoo>